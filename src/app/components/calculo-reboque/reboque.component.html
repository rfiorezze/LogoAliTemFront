<div class="container mt-4">
  <h2 class="text-center mb-4">CÃ¡lculo de Reboque</h2>

  <form [formGroup]="form" class="card p-4 shadow">
    <fieldset [disabled]="solicitacaoEmAndamento">
      <div class="mb-3">
        <label class="form-label">Tipo do VeÃ­culo</label>
        <select class="form-select" formControlName="tipoVeiculo">
          <option value="" disabled selected>Selecione...</option>
          <option value="Leve">Leve (Carros e Motos)</option>
          <option value="Utilitario">UtilitÃ¡rio (Picapes e furgÃµes mÃ©dios)</option>
          <option value="Semi-Pesado">Semi-Pesado (Vans)</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">EndereÃ§o de Retirada</label>
        <div class="input-group">
          <input type="text" id="localRetirada" class="form-control" formControlName="localRetirada"
                 placeholder="Digite ou use geolocalizaÃ§Ã£o" />
          <button type="button" class="btn btn-primary" (click)="usarGeolocalizacao()">ğŸ“</button>
        </div>
        <ul *ngIf="sugestoesRetirada.length > 0" class="list-group">
          <li *ngFor="let sugestao of sugestoesRetirada" class="list-group-item list-group-item-action"
              (click)="selecionarSugestao(sugestao, 'localRetirada')">{{ sugestao }}</li>
        </ul>
      </div>

      <div class="mb-3">
        <label class="form-label">EndereÃ§o de Destino</label>
        <input type="text" id="localDestino" class="form-control" formControlName="localDestino"
               placeholder="Digite o destino" />
        <ul *ngIf="sugestoesDestino.length > 0" class="list-group">
          <li *ngFor="let sugestao of sugestoesDestino" class="list-group-item list-group-item-action"
              (click)="selecionarSugestao(sugestao, 'localDestino')">{{ sugestao }}</li>
        </ul>
      </div>

      <button type="button" class="btn btn-primary w-100" (click)="calcularValor()" [disabled]="solicitacaoEmAndamento">
        Calcular Valor
      </button>
    </fieldset>
  </form>

  <!-- ğŸ”¥ EXIBIR SOMENTE SE O CÃLCULO DE VALOR RETORNAR SUCESSO -->
  <div *ngIf="valorEstimado !== null && !solicitacaoConfirmada" class="mt-4 text-center">
    <h4>Valor Estimado: <span class="badge bg-success">R$ {{ valorEstimado?.toFixed(2) }}</span></h4>
    <button class="btn btn-success mt-2 w-100" (click)="contratarReboque()" [disabled]="solicitacaoEmAndamento">
      ğŸš› Contratar Reboque
    </button>
  </div>

  <!-- ğŸ”¥ SOMENTE EXIBIR SE A SOLICITAÃ‡ÃƒO FOR CONFIRMADA -->
  <div *ngIf="solicitacaoConfirmada" class="mt-4 text-center alert alert-success">
    <h4>âœ… SolicitaÃ§Ã£o registrada com sucesso!</h4>
    <h3>Valor Estimado: <span class="badge bg-success">R$ {{ valorEstimado?.toFixed(2) }}</span></h3>
    <p>Um atendente entrarÃ¡ em contato em breve.</p>    
    <p class="text-muted"><small>ğŸš¨ caso queira agilizar o atendimento, clique no botÃ£o abaixo e acione nosso atendentes atravÃ©s do Whatsapp.</small></p>
    <button class="btn btn-success mt-2 w-100" (click)="enviarWhatsApp()">
      ğŸ“² Solicitar por WhatsApp
    </button>
  </div>
</div>
